mostly copy from https://github.com/shadowsocks/go-shadowsocks2/tree/master/shadowaead
